<!DOCTYPE HTML>
<!--
	kareem
	greatings
	CCA 3.0 license
-->
<html>
<head>
  <title>BALETO</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="assets/css/main.css" />
  <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
  <!-- رابط لـ Font Awesome للأيقونات (مثل أيقونة السهم) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <style>
    /* الأنماط العامة من مشروعك (تم نسخها من index.html لضمان التناسق   ) */
    html, body {
      margin: 0 !important;
      padding: 0 !important;
      height: 100% !important;
      background-image: url('images/b.png') !important;
      background-size: cover !important;
      background-position: center center !important;
      background-repeat: no-repeat !important;
      background-attachment: fixed !important;
      background-color: #1e252d !important;
    }

    #wrapper, #main, .post, section, .post.featured {
      background: transparent !important;
    }

    #intro {
      background-image: url('images/1x.gif') !important;
      background-repeat: no-repeat !important;
      background-size: 100% !important;
      background-position: 50% -600px !important;
      background-color: #004 !important;
      height: 300px;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }

    #intro::before {
      content: "";
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.4);
      z-index: 0;
    }

    #intro * {
      position: relative;
      z-index: 1;
    }

    /* تعديلات على الروابط في Nav لتكون مرئية (تم نسخها من index.html لضمان التناسق) */
    #nav ul.links li a {
        color: black !important;
        font-size: 30px;
        font-weight: bold;
    }
    #nav ul.links li.active a {
        color: white !important;
    }

    /* أنماط عامة للحاسبة المدمجة */
    .combined-calculator-section {
      direction: rtl;
      text-align: right;
      padding: 2rem;
      background: #1e1e1e; /* نفس خلفية حاسبة الخبرة */
      color: #fff;
      border-radius: 1rem;
      max-width: 450px; /* زيادة العرض قليلاً لاستيعاب المحتوى */
      width: 90%; /* لضمان الاستجابة على الشاشات الصغيرة */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* إضافة ظل خفيف */
      margin: 0 auto; /* توسيط الحاسبة داخل الـ Post */
    }

    .combined-calculator-section h2 {
      color: #00ffc8; /* نفس لون عنوان حاسبة الخبرة */
      margin-bottom: 1.5rem;
      font-size: 2.2rem;
      text-align: center;
    }

    .combined-calculator-section label {
      color: #00ffc8;
      display: block;
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
    }

    .combined-calculator-section input[type="number"],
    .combined-calculator-section select {
      width: 100%;
      margin-bottom: 1rem;
      padding: 15px;
      background: #2c2c2c;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      box-sizing: border-box; /* لضمان أن padding لا يزيد العرض */
      -webkit-appearance: none; /* لإزالة الأنماط الافتراضية لـ select */
      -moz-appearance: none;
      appearance: none;
      background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%2300ffc8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"%3e%3cpolyline points="6 9 12 15 18 9"%3e%3c/polyline%3e%3c/svg%3e'  ); /* أيقونة سهم لـ select */
      background-repeat: no-repeat;
      background-position: left 15px center; /* وضع السهم على اليسار */
      padding-left: 40px; /* مسافة للسهم */
    }

    .combined-calculator-section button {
      background: #00ffc8;
      color: black;
      padding: 12px 20px;
      border: none;
      border-radius: 10px;
      width: 100%;
      font-weight: bold;
      cursor: pointer;
      font-size: 1.2rem;
      transition: background-color 0.3s ease;
    }

    .combined-calculator-section button:hover {
      background-color: #00e6b8; /* لون أغمق عند التحويم */
    }

    .combined-calculator-section .result-display {
      margin-top: 1.5rem;
      padding: 1rem;
      background: #2c2c2c;
      border-radius: 8px;
      color: #fff;
      font-size: 1.1rem;
      text-align: center;
    }

    .combined-calculator-section .result-display p {
      margin: 0.5rem 0;
      color: #fff;
    }

    .combined-calculator-section .result-display strong {
      color: #00ffc8;
    }

    /* أنماط خاصة بالقوائم المنسدلة (Dropdowns) */
    .dropdown-container {
        position: relative;
        width: 100%;
        margin-bottom: 1rem;
    }

    .dropdown-button {
        background-color: #2c2c2c; /* نفس لون حقول الإدخال */
        color: #fff;
        padding: 15px 20px;
        font-size: 1rem;
        border: none;
        cursor: pointer;
        width: 100%;
        border-radius: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: background-color 0.3s ease;
        box-sizing: border-box;
    }

    .dropdown-button:hover {
        background-color: #3a3a3a;
    }

    .dropdown-button .fa-chevron-down {
        transition: transform 0.3s ease;
    }

    .dropdown-button.open .fa-chevron-down {
        transform: rotate(180deg);
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #2c2c2c;
        min-width: 100%;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 10; /* لضمان ظهورها فوق العناصر الأخرى */
        border-radius: 8px;
        margin-top: 5px;
        text-align: right;
        max-height: 200px; /* لتحديد ارتفاع أقصى للقائمة */
        overflow-y: auto; /* لإضافة شريط تمرير إذا كانت الخيارات كثيرة */
    }

    .dropdown-content a {
        color: #fff;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        text-align: right;
        transition: background-color 0.2s ease;
    }

    .dropdown-content a:hover {
        background-color: #444;
    }

    .dropdown-content.show {
        display: block;
    }

    /* إخفاء الأقسام الفرعية للحاسبة المدمجة افتراضياً */
    #cargo-inputs, #production-inputs, #custom-cargo-input-container, #oil-gas-inputs {
        display: none;
    }

    /* توسيط الحاسبة داخل Post */
    .post {
        display: flex;
        flex-direction: column;
        align-items: center; /* توسيط أفقي للمحتوى داخل الـ post */
        /* padding: 8rem 8rem 6rem 8rem; */ /* تم تعليق هذا لأن الحاسبة ستضيف padding خاص بها */
    }
    .post > header.major, .post > .image.main, .post > p {
        width: 100%; /* لضمان أن العناصر الأخرى لا تتأثر بالتوسيط */
        max-width: 100%; /* لضمان أن العناصر الأخرى لا تتأثر بالتوسيط */
    }
  </style>

</head>
<body>
  <div id="wrapper">
    <!-- Intro -->
    <div id="intro">
      <h1><span>BALETO</span></h1>

      <p>
        ادوات مساعدة داخل مقاطعة بليتو
        <a href="https://boleto7.com/" target="_blank" style="display: block; margin-top: 10px; color: green; text-decoration: none;">
          موقع بليتو
        </a>
      </p>

      <ul class="actions">
        <li><a href="#header" class="button icon solid solo fa-arrow-down scrolly">Continue</a></li>
      </ul>
    </div>

    <!-- Header -->
    <header id="header">
      <a href="index.html" class="logo">bal wiki</a>
    </header>

    <!-- Nav -->
<nav id="nav">
  <ul class="links">
    <li>
      <a href="index.html" class="flash-link" style="color: #000 !important; font-size: 30px; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">
        حساب الخبرة
      </a>
    </li>
    <li class="active">
      <a href="#combined-calculator-section" class="flash-link" style="color: #000 !important; font-size: 30px; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">
        حساب الحمولات
      </a>
    </li>
    <li>
      <a href="elements.html" class="flash-link" style="color: #000 !important; font-size: 30px; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">
        حساب غير شرعي
      </a>
    </li>
  </ul>
</nav>

<style>
.flash-link {
  animation: flash 2s ease-in-out infinite;
}

@keyframes flash {
  0%, 100% {
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    color: #000;
  }
  50% {
    text-shadow: 0 0 15px #00ffc8, 0 0 10px #00ffc8;
    color: #00ffc8;
  }
}
</style>



    <!-- Main -->
    <div id="main">

      <!-- Post -->
      <section class="post">
        <header class="major">
<!-- تعليمات الإدخال -->
   <div style="display: flex; justify-content: center; align-items: center; min-height: 40vh; text-align: center;">
  <div style="color: #00ffc8; font-size: 24px; font-weight: bold; line-height: 2;">
    <p>**اختر من القائمة واكتب كمية عدة الوظيفة</p>
    <p>السمك والعنب بدون عدة تنحسب بالكمية**</p>
    <p>**النفط والغاز: 20 عدة = 40 كيلو، تنقسم لنفط وغاز منفصلين**</p>
  </div>
</div>

          
        
        <!-- الحاسبة الموحدة هنا -->
        <section id="combined-calculator-section" class="combined-calculator-section">
            <h2>حساب الحمولات والوظايف</h2>

            <label for="calculator-type-select">اختر نوع الحاسبة:</label>
            <div class="dropdown-container">
                <button class="dropdown-button" id="calculatorTypeDropdownBtn">
                    <span>اختر نوع الحاسبة</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="dropdown-content" id="calculatorTypeDropdownContent">
                    <a href="#" data-calc-type="cargo">احسب الحمولة والعدة</a>
                    <a href="#" data-calc-type="production">احسب الخبرة والانتاج</a>
                    <a href="#" data-calc-type="double-exp">احسب ضعف الخبرة</a>
                    <a href="#" data-calc-type="oil-gas">احسب النفط والغاز</a>
                </div>
            </div>

            <!-- قسم حاسبة الحمولة (يظهر عند الاختيار  ) -->
            <div id="cargo-inputs">
                <label for="cargo-capacity-select">اختر حمولة السيارة:</label>
                <div class="dropdown-container">
                    <button class="dropdown-button" id="cargoCapacityDropdownBtn">
                        <span>اختر الحمولة</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-content" id="cargoCapacityDropdownContent">
                        <a href="#" data-cargo="40">سيارة حمولة 40 كيلو</a>
                        <a href="#" data-cargo="60">سيارة حمولة 60 كيلو</a>
                        <a href="#" data-cargo="80">سيارة حمولة 80 كيلو</a>
                        <a href="#" data-cargo="120">سيارة حمولة 120 كيلو</a>
                        <a href="#" data-cargo="250">سيارة حمولة 250 كيلو</a>
                        <a href="#" data-cargo="500">سيارة حمولة 500 كيلو</a>
                        <a href="#" data-cargo="custom">حمولة أخرى (أدخل يدويًا)</a>
                    </div>
                </div>
                <div id="custom-cargo-input-container">
                    <label for="custom-cargo-input">أدخل الحمولة بالكيلو:</label>
                    <input type="number" id="custom-cargo-input" min="0" value="0">
                </div>
            </div>

            <!-- قسم حاسبة الإنتاج (يظهر عند الاختيار) -->
            <div id="production-inputs">
                <label for="job-type-select">اختر نوع الشغل:</label>
                <div class="dropdown-container">
                    <button class="dropdown-button" id="jobTypeDropdownBtn">
                        <span>اختر نوع الشغل</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-content" id="jobTypeDropdownContent">
                        <a href="#" data-job="grape">عنب</a>
                        <a href="#" data-job="honey">مناحل عسل</a>
                        <a href="#" data-job="cement">أسمنت</a>
                        <a href="#" data-job="ranch">مراعي</a>
                        <a href="#" data-job="wood">أخشاب</a>
                        <a href="#" data-job="fabric">أقمشة</a>
                        <a href="#" data-job="fish">أسماك</a>
                    </div>
                </div>

                <label for="input-amount" id="input-label">أدخل العدد:</label>
                <input type="number" id="input-amount" min="0" value="0">
            </div>

            <!-- قسم حاسبة النفط والغاز (جديد) -->
            <div id="oil-gas-inputs">
                <label for="oil-gas-type-select">اختر نوع العملية:</label>
                <div class="dropdown-container">
                    <button class="dropdown-button" id="oilGasTypeDropdownBtn">
                        <span>اختر نوع العملية</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-content" id="oilGasTypeDropdownContent">
                        
                        <a href="#" data-oil-gas-type="oil-only">نفط</a>
                        <a href="#" data-oil-gas-type="gas-only">غاز</a>
                    </div>
                </div>

                <label for="oil-gas-amount" id="oil-gas-label">أدخل عدد العدة:</label>
                <input type="number" id="oil-gas-amount" min="0" value="0">
            </div>

            <button id="calculateCombinedBtn">احسب</button>

            <div id="combined-result" class="result-display">
                <p>النتائج ستظهر هنا.</p>
            </div>
        

    </div> <!-- إغلاق div#main -->

    

    <!-- Copyright -->
    <div id="copyright">
      <ul>
        <li>&copy; BAL</li>
        <li>Design: kareem</li>
      </ul>
    </div>
  </div> <!-- إغلاق div#wrapper -->

  <!-- Scripts -->
  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/jquery.scrollex.min.js"></script>
  <script src="assets/js/jquery.scrolly.min.js"></script>
  <script src="assets/js/browser.min.js"></script>
  <script src="assets/js/breakpoints.min.js"></script>
  <script src="assets/js/util.js"></script>
  <script src="assets/js/main.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
        // عناصر الحاسبة الموحدة
        const calculatorTypeDropdownBtn = document.getElementById('calculatorTypeDropdownBtn');
        const calculatorTypeDropdownContent = document.getElementById('calculatorTypeDropdownContent');
        const cargoInputs = document.getElementById('cargo-inputs');
        const productionInputs = document.getElementById('production-inputs');
        const oilGasInputs = document.getElementById('oil-gas-inputs');
        const calculateCombinedBtn = document.getElementById('calculateCombinedBtn');
        const combinedResultDisplay = document.getElementById('combined-result');

        let currentCalculatorType = null; // لتخزين نوع الحاسبة المختار
        let isDoubleExpMode = false; // متغير لتحديد ما إذا كنا في وضع ضعف الخبرة

        // عناصر حاسبة الحمولة
        const cargoCapacityDropdownBtn = document.getElementById('cargoCapacityDropdownBtn');
        const cargoCapacityDropdownContent = document.getElementById('cargoCapacityDropdownContent');
        const customCargoInputContainer = document.getElementById('custom-cargo-input-container');
        const customCargoInput = document.getElementById('custom-cargo-input');
        let selectedCargoCapacity = null;

        // عناصر حاسبة الإنتاج
        const jobTypeDropdownBtn = document.getElementById('jobTypeDropdownBtn');
        const jobTypeDropdownContent = document.getElementById('jobTypeDropdownContent');
        const inputAmountField = document.getElementById('input-amount');
        const inputLabel = document.getElementById('input-label');
        let selectedJobType = null;

        // عناصر حاسبة النفط والغاز (جديد)
        const oilGasTypeDropdownBtn = document.getElementById('oilGasTypeDropdownBtn');
        const oilGasTypeDropdownContent = document.getElementById('oilGasTypeDropdownContent');
        const oilGasAmountField = document.getElementById('oil-gas-amount');
        const oilGasLabel = document.getElementById('oil-gas-label');
        let selectedOilGasType = null;

        // بيانات الخبرة لكل نوع شغل (محدث)
        const jobData = {
            grape: { unitName: 'عصير', expPerUnit: 8, inputType: 'amount', weightPerUnit: 0.4 },
            honey: { unitName: 'عسل', expPerUnit: 8, inputType: 'tools', toolsNeeded: 20, outputUnits: 100, weightPerOutput: 0.4 },
            cement: { unitName: 'أسمنت', expPerUnit: 8, inputType: 'tools', toolsNeeded: 20, outputUnits: 100, weightPerOutput: 0.4 },
            ranch: { unitName: 'حليب', expPerUnit: 8, inputType: 'tools', toolsNeeded: 20, outputUnits: 100, weightPerOutput: 0.4 },
            wood: { unitName: 'قطعة خشب', expPerUnit: 9, inputType: 'tools', toolsNeeded: 20, outputUnits: 100, weightPerOutput: 0.4 },
            fabric: { unitName: 'ملابس', expPerUnit: 7, inputType: 'tools', toolsNeeded: 20, outputUnits: 100, weightPerOutput: 0.4 },
            fish: { unitName: 'سمكة', expPerUnit: 11, inputType: 'amount', weightPerUnit: 0.4 } // تم تعديل وزن السمك من 1 إلى 0.4 كيلو
        };

        // بيانات النفط والغاز (جديد)
        const oilGasData = {
            combined: {
                toolsNeeded: 20, // 20 عدة مدمجة
                totalWeight: 40, // تساوي 40 كيلو
                gasExp: 11, // الغاز يعطي 11 خبرة
                oilExp: 10  // النفط يعطي 10 خبرة
            },
            oil: {
                toolsNeeded: 20, // 20 عدة نفط
                totalWeight: 40, // تساوي 40 كيلو
                outputUnits: 80, // تنتج 80 أنبوب نفط
                expPerUnit: 10   // كل أنبوب يعطي 10 خبرة
            },
            gas: {
                toolsNeeded: 20, // 20 عدة غاز
                totalWeight: 40, // تساوي 40 كيلو
                outputUnits: 80, // تنتج 80 أسطوانة غاز
                expPerUnit: 11   // كل أسطوانة تعطي 11 خبرة
            }
        };

        // =======================================================
        // وظائف مساعدة لفتح/إغلاق القوائم المنسدلة
        // =======================================================
        function toggleDropdown(button, content) {
            content.classList.toggle('show');
            button.classList.toggle('open');
        }

        function closeDropdown(button, content) {
            content.classList.remove('show');
            button.classList.remove('open');
        }

        // =======================================================
        // التحكم في اختيار نوع الحاسبة
        // =======================================================
        calculatorTypeDropdownBtn.addEventListener('click', function(event) {
            event.stopPropagation();
            toggleDropdown(this, calculatorTypeDropdownContent);
        });

        calculatorTypeDropdownContent.addEventListener('click', function(event) {
            if (event.target.tagName === 'A') {
                event.preventDefault();
                currentCalculatorType = event.target.dataset.calcType;
                const calculatorName = event.target.textContent;

                calculatorTypeDropdownBtn.querySelector('span').textContent = calculatorName;
                closeDropdown(calculatorTypeDropdownBtn, calculatorTypeDropdownContent);

                // إعادة تعيين وضع ضعف الخبرة
                isDoubleExpMode = (currentCalculatorType === 'double-exp');

                // إظهار/إخفاء الأقسام بناءً على الاختيار
                cargoInputs.style.display = 'none';
                productionInputs.style.display = 'none';
                oilGasInputs.style.display = 'none';
                customCargoInputContainer.style.display = 'none';

                if (currentCalculatorType === 'cargo') {
                    cargoInputs.style.display = 'block';
                    combinedResultDisplay.innerHTML = `<p>الحمولة المختارة: <strong>لا شيء</strong></p><p>عدد العدة التي يمكن حملها: <strong>0 عدة</strong></p>`;
                    selectedCargoCapacity = null;
                    cargoCapacityDropdownBtn.querySelector('span').textContent = 'اختر الحمولة';
                    customCargoInput.value = 0;
                } else if (currentCalculatorType === 'production' || currentCalculatorType === 'double-exp') {
                    productionInputs.style.display = 'block';
                    combinedResultDisplay.innerHTML = `<p>نوع الشغل: <strong>لا شيء</strong></p><p>الإنتاج المتوقع: <strong>0 وحدة</strong></p><p>الوزن الإجمالي: <strong>0 كيلو</strong></p><p>الخبرة المتوقعة: <strong>0 خبرة</strong></p>`;
                    selectedJobType = null;
                    jobTypeDropdownBtn.querySelector('span').textContent = 'اختر نوع الشغل';
                    inputAmountField.value = 0;
                    inputLabel.textContent = 'أدخل العدد:';
                } else if (currentCalculatorType === 'oil-gas') {
                    oilGasInputs.style.display = 'block';
                    combinedResultDisplay.innerHTML = `<p>نوع العملية: <strong>لا شيء</strong></p><p>الإنتاج المتوقع: <strong>0 وحدة</strong></p><p>الوزن الإجمالي: <strong>0 كيلو</strong></p><p>الخبرة المتوقعة: <strong>0 خبرة</strong></p>`;
                    selectedOilGasType = null;
                    oilGasTypeDropdownBtn.querySelector('span').textContent = 'اختر نوع العملية';
                    oilGasAmountField.value = 0;
                    oilGasLabel.textContent = 'أدخل عدد العدة:';
                }
            }
        });

        // =======================================================
        // التحكم في حاسبة الحمولة
        // =======================================================
        cargoCapacityDropdownBtn.addEventListener('click', function(event) {
            event.stopPropagation();
            toggleDropdown(this, cargoCapacityDropdownContent);
        });

        cargoCapacityDropdownContent.addEventListener('click', function(event) {
            if (event.target.tagName === 'A') {
                event.preventDefault();
                selectedCargoCapacity = event.target.dataset.cargo;
                cargoCapacityDropdownBtn.querySelector('span').textContent = event.target.textContent;
                closeDropdown(cargoCapacityDropdownBtn, cargoCapacityDropdownContent);

                if (selectedCargoCapacity === 'custom') {
                    customCargoInputContainer.style.display = 'block';
                    customCargoInput.focus();
                } else {
                    customCargoInputContainer.style.display = 'none';
                }
            }
        });

        // =======================================================
        // التحكم في حاسبة الإنتاج
        // =======================================================
        jobTypeDropdownBtn.addEventListener('click', function(event) {
            event.stopPropagation();
            toggleDropdown(this, jobTypeDropdownContent);
        });

        jobTypeDropdownContent.addEventListener('click', function(event) {
            if (event.target.tagName === 'A') {
                event.preventDefault();
                selectedJobType = event.target.dataset.job;
                const jobName = event.target.textContent;

                jobTypeDropdownBtn.querySelector('span').textContent = jobName;
                closeDropdown(jobTypeDropdownBtn, jobTypeDropdownContent);

                // تغيير نص التسمية بناءً على نوع الشغل
                if (jobData[selectedJobType].inputType === 'amount') {
                    inputLabel.textContent = `أدخل عدد ${jobData[selectedJobType].unitName}:`;
                } else {
                    inputLabel.textContent = 'أدخل عدد العدة:';
                }
                inputAmountField.value = 0;
            }
        });

        // =======================================================
        // التحكم في حاسبة النفط والغاز (جديد)
        // =======================================================
        oilGasTypeDropdownBtn.addEventListener('click', function(event) {
            event.stopPropagation();
            toggleDropdown(this, oilGasTypeDropdownContent);
        });

        oilGasTypeDropdownContent.addEventListener('click', function(event) {
            if (event.target.tagName === 'A') {
                event.preventDefault();
                selectedOilGasType = event.target.dataset.oilGasType;
                const typeName = event.target.textContent;

                oilGasTypeDropdownBtn.querySelector('span').textContent = typeName;
                closeDropdown(oilGasTypeDropdownBtn, oilGasTypeDropdownContent);

                oilGasAmountField.value = 0;
            }
        });

        // =======================================================
        // دالة الحساب الرئيسية
        // =======================================================
        calculateCombinedBtn.addEventListener('click', function() {
            if (!currentCalculatorType) {
                combinedResultDisplay.innerHTML = `<p style="color:red;">يرجى اختيار نوع الحاسبة أولاً.</p>`;
                return;
            }

            if (currentCalculatorType === 'cargo') {
                let finalCargoValue;
                if (selectedCargoCapacity === 'custom') {
                    finalCargoValue = parseInt(customCargoInput.value);
                    if (isNaN(finalCargoValue) || finalCargoValue <= 0) {
                        combinedResultDisplay.innerHTML = `<p style="color:red;">يرجى إدخال حمولة مخصصة صحيحة.</p>`;
                        return;
                    }
                } else if (selectedCargoCapacity) {
                    finalCargoValue = parseInt(selectedCargoCapacity);
                } else {
                    combinedResultDisplay.innerHTML = `<p style="color:red;">يرجى اختيار حمولة السيارة.</p>`;
                    return;
                }

                const toolsPer40kg = 20;
                const toolsCapacity = (finalCargoValue / 40) * toolsPer40kg;

                combinedResultDisplay.innerHTML = `
                    <p>الحمولة المختارة: <strong>${finalCargoValue} كيلو</strong></p>
                    <p>عدد العدة التي يمكن حملها: <strong>${toolsCapacity} عدة</strong></p>
                `;
            } else if (currentCalculatorType === 'production' || currentCalculatorType === 'double-exp') {
                const inputAmount = parseInt(inputAmountField.value);
                let productionUnits = 0;
                let totalWeight = 0;
                let expectedExp = 0;
                let unitName = '';

                if (isNaN(inputAmount) || inputAmount < 0) {
                    combinedResultDisplay.innerHTML = `<p style="color:red;">يرجى إدخال قيمة صحيحة.</p>`;
                    return;
                }

                if (!selectedJobType) {
                    combinedResultDisplay.innerHTML = `<p style="color:red;">يرجى اختيار نوع الشغل أولاً.</p>`;
                    return;
                }

                const jobInfo = jobData[selectedJobType];
                unitName = jobInfo.unitName;

                if (jobInfo.inputType === 'amount') {
                    productionUnits = inputAmount;
                    totalWeight = inputAmount * jobInfo.weightPerUnit;
                    expectedExp = inputAmount * jobInfo.expPerUnit;
                } else {
                    productionUnits = (inputAmount / jobInfo.toolsNeeded) * jobInfo.outputUnits;
                    totalWeight = (inputAmount / jobInfo.toolsNeeded) * (jobInfo.outputUnits * jobInfo.weightPerOutput);
                    expectedExp = productionUnits * jobInfo.expPerUnit;
                }

                if (isDoubleExpMode) {
                    expectedExp *= 2;
                }

                combinedResultDisplay.innerHTML = `
                    <p>نوع الشغل: <strong>${jobTypeDropdownBtn.querySelector('span').textContent}</strong></p>
                    <p>الإنتاج المتوقع: <strong>${productionUnits.toFixed(0)} ${unitName}</strong></p>
                    <p>الوزن الإجمالي: <strong>${totalWeight.toFixed(2)} كيلو</strong></p>
                    <p>الخبرة المتوقعة: <strong>${expectedExp.toFixed(0)} خبرة</strong></p>
                `;
            } else if (currentCalculatorType === 'oil-gas') {
                const inputAmount = parseInt(oilGasAmountField.value);

                if (isNaN(inputAmount) || inputAmount < 0) {
                    combinedResultDisplay.innerHTML = `<p style="color:red;">يرجى إدخال قيمة صحيحة.</p>`;
                    return;
                }

                if (!selectedOilGasType) {
                    combinedResultDisplay.innerHTML = `<p style="color:red;">يرجى اختيار نوع العملية أولاً.</p>`;
                    return;
                }

                let resultHTML = '';
                const typeName = oilGasTypeDropdownBtn.querySelector('span').textContent;

                if (selectedOilGasType === 'combined') {
                    // عدة مدمجة: 20 عدة = 40 كيلو، تعطي خبرة غاز (11) ونفط (10)
                    const totalWeight = (inputAmount / oilGasData.combined.toolsNeeded) * oilGasData.combined.totalWeight;
                    const gasExp = (inputAmount / oilGasData.combined.toolsNeeded) * oilGasData.combined.gasExp;
                    const oilExp = (inputAmount / oilGasData.combined.toolsNeeded) * oilGasData.combined.oilExp;
                    const totalExp = gasExp + oilExp;

                    resultHTML = `
                        <p>نوع العملية: <strong>${typeName}</strong></p>
                        <p>الوزن الإجمالي: <strong>${totalWeight.toFixed(2)} كيلو</strong></p>
                        <p>خبرة الغاز: <strong>${gasExp.toFixed(0)} خبرة</strong></p>
                        <p>خبرة النفط: <strong>${oilExp.toFixed(0)} خبرة</strong></p>
                        <p>إجمالي الخبرة: <strong>${totalExp.toFixed(0)} خبرة</strong></p>
                    `;
                } else if (selectedOilGasType === 'oil-only') {
                    // نفط فقط: 20 عدة = 40 كيلو = 80 أنبوب نفط
                    const totalWeight = (inputAmount / oilGasData.oil.toolsNeeded) * oilGasData.oil.totalWeight;
                    const oilPipes = (inputAmount / oilGasData.oil.toolsNeeded) * oilGasData.oil.outputUnits;
                    const totalExp = oilPipes * oilGasData.oil.expPerUnit;

                    resultHTML = `
                        <p>نوع العملية: <strong>${typeName}</strong></p>
                        <p>الإنتاج المتوقع: <strong>${oilPipes.toFixed(0)} أنبوب نفط</strong></p>
                        <p>الوزن الإجمالي: <strong>${totalWeight.toFixed(2)} كيلو</strong></p>
                        <p>الخبرة المتوقعة: <strong>${totalExp.toFixed(0)} خبرة</strong></p>
                    `;
                } else if (selectedOilGasType === 'gas-only') {
                    // غاز فقط: 20 عدة = 40 كيلو = 80 أسطوانة غاز
                    const totalWeight = (inputAmount / oilGasData.gas.toolsNeeded) * oilGasData.gas.totalWeight;
                    const gasCylinders = (inputAmount / oilGasData.gas.toolsNeeded) * oilGasData.gas.outputUnits;
                    const totalExp = gasCylinders * oilGasData.gas.expPerUnit;

                    resultHTML = `
                        <p>نوع العملية: <strong>${typeName}</strong></p>
                        <p>الإنتاج المتوقع: <strong>${gasCylinders.toFixed(0)} أسطوانة غاز</strong></p>
                        <p>الوزن الإجمالي: <strong>${totalWeight.toFixed(2)} كيلو</strong></p>
                        <p>الخبرة المتوقعة: <strong>${totalExp.toFixed(0)} خبرة</strong></p>
                    `;
                }

                combinedResultDisplay.innerHTML = resultHTML;
            }
        });

        // =======================================================
        // إغلاق جميع القوائم المنسدلة عند الضغط خارجها
        // =======================================================
        window.addEventListener('click', function(event) {
            const dropdowns = document.querySelectorAll('.dropdown-container');
            dropdowns.forEach(function(container) {
                const button = container.querySelector('.dropdown-button');
                const content = container.querySelector('.dropdown-content');
                if (button && content && !button.contains(event.target) && !content.contains(event.target)) {
                    closeDropdown(button, content);
                }
            });
        });
    });
  </script>

</body>
</html>

